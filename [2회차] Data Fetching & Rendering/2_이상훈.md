# Forms and Mutations

Formì€ ì‚¬ìš©ìê°€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œí•˜ëŠ” ìš”ì†Œì…ë‹ˆë‹¤.

Next.jsë¥¼ í™œìš©í•˜ë©´ í¼ ì „ì†¡ê³¼ ë°ì´í„° ë³€ê²½ì„ **Server Action** ì´ë¼ëŠ” ê°œë…ì„ í†µí•´ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ë³´í†µ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìˆ˜ì •í•˜ê³  ì‹¶ë‹¤ë©´ ì„œë²„ì˜ APIë¥¼ ê±°ì³ì•¼ í•˜ëŠ”ë°,
> ê·¸ëƒ¥ `page.js` ì•ˆì—ì„œ ë°”ë¡œ í•´ê²°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.
> Next.js 13.4 ë²„ì „ ì´í›„ë¶€í„° ì‚¬ìš© ê°€ëŠ¥í•œ ì‹¤í—˜ì  ê¸°ëŠ¥ì…ë‹ˆë‹¤.

## ì‹œì‘ì— ì•ì„œì„œ..

ì œê°€ í•™ìŠµí•˜ë©´ì„œ ëŠë‚€ ìƒê°ì„ ê³µìœ í•˜ìë©´.. ì´ ì„œë²„ ì•¡ì…˜ì´ë¼ëŠ” ê°œë…ì€ **ì•„ì§ ì‹¤í—˜ì ì¸ ê¸°ëŠ¥**ìœ¼ë¡œ ë³´ì˜€ìŠµë‹ˆë‹¤.

íŠ¹íˆ `useFormState()`, `useFormStatus()`, `useOptimistic()` ë“±ì˜ **í›…ì— ëŒ€í•œ ìì„¸í•œ ëª…ì„¸**ë¥¼ ë¦¬ì•¡íŠ¸ ê³µì‹ë¬¸ì„œë‚˜ Next.js ê³µì‹ë¬¸ì„œì—ì„œë„ ì°¾ì•„ë³¼ ìˆ˜ ì—†ì—ˆì–´ìš”.. ê·¸ë˜ì„œ ì‹¤ì œë¡œ ì‚¬ìš©í•œë‹¤ë©´ ì‚½ì§ˆê³¼ íƒêµ¬ê°€ í•„ìš”í•œ ë¶€ë¶„ì¼ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/f440ff37-7edf-432a-81b4-28679a1e6fd9)

[Next.js API Reference](https://nextjs.org/docs/app/api-reference/functions/server-actions#additional-resources) ì— ì‚´í´ë³´ë©´, ì•„ì§ ë¬¸ì„œí™” ì‘ì—…ì´ ì§„í–‰ì¤‘ì´ë¼ë„¤ìš”.

## ì„œë²„ ì•¡ì…˜ì´ ë™ì‘í•˜ëŠ” ë°©ì‹

ì„œë²„ ì•¡ì…˜ì„ ì‚¬ìš©í•˜ë©´ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ëŒ€ì‹  ì»´í¬ë„ŒíŠ¸ì—ì„œ ì§ì ‘ ë¶€ë¥¼ ìˆ˜ ìˆëŠ” ë¹„ë™ê¸° ì„œë²„ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ë©´ ë©ë‹ˆë‹¤.

ì„œë²„ ì•¡ì…˜ì€ **ì„œë²„ ì»´í¬ë„ŒíŠ¸ ë‚´ì— ì •ì˜**ë˜ê³ , í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶ˆë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì•ˆì— actionì„ ì •ì˜í•˜ë©´, form ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—†ì´ ë™ì‘ ê°€ëŠ¥í•˜ê²Œ í•˜ê³  ì´ëŠ” ì ì§„ì ì¸ í–¥ìƒì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

ì„œë²„ ì•¡ì…˜ì„ í™œì„±í™” í•˜ëŠ” ë°©ë²•ì€ `next.config.js` íŒŒì¼ì„ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤:

```js
module.exports = {
  experimental: {
    serverActions: true,
  },
};
```

> ì•Œì•„ ë‘ë©´ ì¢‹ì€ íŒ
>
> - ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„œë²„ ì•¡ì…˜ì„ í˜¸ì¶œí•˜ëŠ” Formì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—†ì´ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> - í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„œë²„ ì•¡ì…˜ì„ í˜¸ì¶œí•˜ëŠ” Formì€ ì œì¶œì„ íì— ë“±ë¡í•©ë‹ˆë‹¤.
>   - ë§Œì•½ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì•˜ë‹¤ë©´, í´ë¼ì´ì–¸íŠ¸ hydrationì—ì„œ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
> - ì„œë²„ ì•¡ì…˜ì€ ìì‹ ì´ ì‚¬ìš©ëœ pageë‚˜ layoutì˜ ì‹¤í–‰ í™˜ê²½ì„ ë¬¼ë ¤ë°›ìŠµë‹ˆë‹¤.
>   - (Node.js í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ë©´ Node.js, Edge í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ë©´ Edgeë¥¼ ì´ì•¼ê¸°í•˜ëŠ” ê²ƒ ê°™ì•„ìš”)
> - ì„œë²„ ì•¡ì…˜ì€ fully static routesì™€ í•¨ê»˜ ë™ì‘í•©ë‹ˆë‹¤. (ë°ì´í„°ë¥¼ revalidatingí•˜ëŠ” ISR í¬í•¨)

## ìºì‹œ ë°ì´í„° ë¬´íš¨í™”

ì„œë²„ ì•¡ì…˜ì€ Next.jsì˜ ìºì‹± ë° ë¬´íš¨í™” êµ¬ì¡°ì™€ ê¸´ë°€í•˜ê²Œ í†µí•©ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ formì´ ì „ì†¡ë  ë•Œ ìºì‹œëœ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜, íŠ¹ì • cache keyì˜ ë¬´íš¨í™”ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì „í†µì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ë¼ìš°íŒ… ê²½ë¡œë§ˆë‹¤ í•˜ë‚˜ì˜ í¼ë§Œ ê°€ì§ˆ ìˆ˜ ìˆì—ˆì§€ë§Œ, ì„œë²„ ì•¡ì…˜ì€ **ë¼ìš°íŒ… ê²½ë¡œë§ˆë‹¤ ì—¬ëŸ¬ í¼ì„ ê°€ì§ˆ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤**. ë˜í•œ, í¼ ì „ì†¡ì‹œì— ë¸Œë¼ìš°ì €ê°€ ìƒˆë¡œê³ ì¹¨ ë  í•„ìš”ë„ ì—†ìŠµë‹ˆë‹¤.

ë˜í•œ Next.jsëŠ” ì—…ë°ì´íŠ¸ ëœ UIë‘ ìƒˆë¡œìš´ ê³ ì³ì§„ ë°ì´í„°ë¥¼ ëª¨ë‘ ë‹¨ì¼ ë„¤íŠ¸ì›Œí¬ ì™•ë³µì— ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì˜ˆì‹œ

### ì„œë²„ ì „ìš© í¼

ì„œë²„ ì „ìš© í¼ì„ ë§Œë“œë ¤ë©´ ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„œë²„ ì•¡ì…˜ì„ ì •ì˜í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ ë°©ë²•ì€ í•¨ìˆ˜ì˜ ë§¨ ìœ„ í˜¹ì€ íŒŒì¼ì˜ ë§¨ ìœ„ì— `use server` ë””ë ‰í‹°ë¸Œë¥¼ ì •ì˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

```tsx
export default function Page() {
  async function create(formData: FormData) {
    'use server';

    // mutate data
    // revalidate cache
  }

  return <form action={create}>...</form>;
}
```

> `<form action={create}>` ëŠ” FormData íƒ€ì…ì„ ë°›ìŠµë‹ˆë‹¤.  
> ë§Œì•½ HTML formì— FormDataê°€ ì „ì†¡ëœë‹¤ë©´, `create` ë¼ëŠ” Server Actionì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ê¸°ë³¸ì ìœ¼ë¡œ ì„œë²„ ì•¡ì…˜ì´ ë™ì‘í•œë‹¤ê³  ê¸°ì¡´ì˜ í˜ì´ì§€ì—ì„œ ìºì‹±ëœ ë‚´ìš©ì´ ì¦‰ê° ì—…ë°ì´íŠ¸ ë˜ëŠ”ê±´ ì•„ë‹ˆê¸°ì—, ë°ì´í„°ë¥¼ ë¬´íš¨í™”í•´ì„œ ìƒˆë¡­ê²Œ ê°€ì ¸ì˜¤ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.

### ë°ì´í„° ë¬´íš¨í™”

`revalidatePath` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ íŠ¹ì • URL ê²½ë¡œì—ì„œ ì €ì¥ëœ ìºì‹œë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts
'use server';

import { revalidatePath } from 'next/cache';

export default async function submit() {
  await submitForm();
  revalidatePath('/');
}
```

`revalidateTag` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ íŠ¹ì • ì‹ë³„ìì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë¬´íš¨í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> [fetch](https://nextjs.org/docs/app/api-reference/functions/fetch#optionsnexttags) í•¨ìˆ˜ì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ ì¤„ ìˆ˜ ìˆëŠ” `tags` ì™€ ì—°ê´€ì´ ìˆëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.

```ts
'use server';

import { revalidateTag } from 'next/cache';

export default async function submit() {
  await addPost();
  revalidateTag('posts');
}
```

### ë¦¬ë‹¤ì´ë ‰ì…˜

ì„œë²„ ì•¡ì…˜ì´ ì™„ë£Œëœ í›„ì— ì‚¬ìš©ìë¥¼ íŠ¹ì • í˜ì´ì§€ë¡œ ì´ë™ì‹œí‚¤ê³  ì‹¶ë‹¤ë©´, `redirect` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```ts
'use server';

import { redirect } from 'next/navigation';
import { revalidateTag } from 'next/cache';

export default async function submit() {
  const id = await addPost();
  revalidateTag('posts'); // Update cached posts
  redirect(`/post/${id}`); // Navigate to new route
}
```

### í¼ ìœ íš¨ì„± ê²€ì‚¬

HTML ìš”ì†Œì— ê¸°ë³¸ì ìœ¼ë¡œ ì •ì˜ëœ `required` ë‚˜ `type="email"` ê°™ì€ ê¸°ë³¸ í¼ ìœ íš¨ì„± ê²€ì‚¬ ê·œì¹™ì„ ê¶Œì¥í•˜ëŠ”ë°, ë” ë°œì „ëœ ì„œë²„ ì‚¬ì´ë“œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì›í•œë‹¤ë©´ `zod` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.

```ts
import { z } from 'zod';

const schema = z.object({
  // ...
});

export default async function submit(formData: FormData) {
  const parsed = schema.parse({
    id: formData.get('id'),
  });
  // ...
}
```

### ë¡œë”© ìƒíƒœ ë³´ì—¬ì£¼ê¸°

`useFormStatus` í›…ì„ ì‚¬ìš©í•˜ë©´ í¼ì´ ì„œë²„ì— ì „ì†¡ë  ë•Œ ë¡œë”© ìƒíƒœë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í›…ì€ ì„œë²„ ì•¡ì…˜ì„ ì‚¬ìš©í•  ë•Œ `form` íƒœê·¸ì˜ ìì‹ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### app/form/components/SubmitButton.tsx

```tsx
'use client';

import { experimental_useFormStatus as useFormStatus } from 'react-dom';

export function SubmitButton() {
  const { pending } = useFormStatus();

  return (
    <button type="submit" aria-disabled={pending}>
      Submit {pending && 'ing...'}
    </button>
  );
}
```

ê·¸ë¦¬ê³  ì´ë ‡ê²Œ ì •ì˜ëœ `<SubmitButton />` ì»´í¬ë„ŒíŠ¸ëŠ” ì„œë²„ ì•¡ì…˜ì´ ì‚¬ìš©ëœ `form` íƒœê·¸ì˜ ìì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### app/form/page.tsx

```tsx
import { SubmitButton } from './components/SubmitButton';

const sleep = async (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));

export default function Page() {
  async function login(formData: FormData) {
    'use server';

    await sleep(2000);
    console.log(formData);
  }

  return (
    <form action={login}>
      <input type="text" name="username" />
      <input type="password" name="password" />
      <SubmitButton />
    </form>
  );
}
```

### ì—ëŸ¬ í•¸ë“¤ë§

ì„œë²„ ì•¡ì…˜ì€ serializable object ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì„œë²„ ì•¡ì…˜ì€ **ìƒˆë¡œìš´ ì•„ì´í…œì„ ìƒì„±í•˜ëŠ” ë¡œì§ì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ìºì¹˜**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì•„ì´í…œ ìƒì„± ë¡œì§

```ts
'use server';

export async function createTodo(prevState: any, formData: FormData) {
  try {
    await createItem(formData.get('todo'));
    return revalidatePath('/');
  } catch (e) {
    return { message: 'Failed to create' };
  }
}
```

ì´ë ‡ê²Œ ì •ì˜ëœ ì„œë²„ ì•¡ì…˜ì„ í†µí•´ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°’ì„ ì½ê±°ë‚˜ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì»´í¬ë„ŒíŠ¸

```tsx
'use client';

import { experimental_useFormState as useFormState } from 'react-dom';
import { experimental_useFormStatus as useFormStatus } from 'react-dom';
import { createTodo } from '@/app/actions';

const initialState = {
  message: null,
};

function SubmitButton() {
  const { pending } = useFormStatus();

  return (
    <button type="submit" aria-disabled={pending}>
      Add
    </button>
  );
}

export function AddForm() {
  const [state, formAction] = useFormState(createTodo, initialState);

  return (
    <form action={formAction}>
      <label htmlFor="todo">Enter Task</label>
      <input type="text" id="todo" name="todo" required />
      <SubmitButton />
      <p aria-live="polite" className="sr-only">
        {state?.message}
      </p>
    </form>
  );
}
```

### ë‚™ê´€ì  ì—…ë°ì´íŠ¸

`useOptimistic` í›…ì„ ì‚¬ìš©í•˜ë©´ ì„œë²„ ì•¡ì…˜ ë™ì‘ì´ ëë‚˜ê¸° ì „ì— ë¯¸ë¦¬ UIë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
'use client';

import { experimental_useOptimistic as useOptimistic } from 'react';
import { send } from './actions';

type Message = {
  message: string;
};

export function Thread({ messages }: { messages: Message[] }) {
  const [optimisticMessages, addOptimisticMessage] = useOptimistic<Message[]>(
    messages,
    (state: Message[], newMessage: string) => [...state, { message: newMessage }]
  );

  return (
    <div>
      {optimisticMessages.map((m, k) => (
        <div key={k}>{m.message}</div>
      ))}
      <form
        action={async (formData: FormData) => {
          const message = formData.get('message');
          addOptimisticMessage(message);
          await send(message);
        }}
      >
        <input type="text" name="message" />
        <button type="submit">Send</button>
      </form>
    </div>
  );
}
```

### ì¿ í‚¤ í•¸ë“¤ë§

`cookies` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ì¿ í‚¤ë¥¼ ì½ê³ , ì„¤ì •í•˜ê³ , ì§€ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts
'use server';

import { cookies } from 'next/headers';

export async function create() {
  const cart = {
    id: '1',
    items: ['ê·¤', 'ì‚¬ê³¼', 'ë°°'],
  };

  cookies().set('cartId', cart.id);
}

export async function read() {
  const cartId = cookies().get('cartId');
  return cartId;
}

export async function remove() {
  cookies().delete('cartId');
}
```

# Edge and Node.js Runtimes

Next.js ì—ì„œ runtimeì˜ ì˜ë¯¸ëŠ” í•´ë‹¹ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬, API, ì¼ë°˜ ê¸°ëŠ¥ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì„œë²„ì—ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì˜ ì¼ë¶€ë¥¼ ë Œë”ë§í•  ìˆ˜ ìˆëŠ” ë‘ ê°€ì§€ ëŸ°íƒ€ì„ì´ ìˆìŠµë‹ˆë‹¤:

- Node.js(ê¸°ë³¸): ëª¨ë“  Node.jsì˜ API ë° í˜¸í™˜ ê°€ëŠ¥í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Edge: [Web API](https://nextjs.org/docs/app/api-reference/edge)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì œê³µí•˜ëŠ” ê²ƒë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Edge Computingì´ë€?

![CDN](https://cf-assets.www.cloudflare.com/slt3lc6tev37/7Dy6rquZDDKSJoeS27Y6xc/4a671b7cc7894a475a94f0140981f5d9/what_is_a_cdn_distributed_server_map.png)

ê³µì‹ ë¬¸ì„œì— ì¡´ì¬í•˜ëŠ” ë‚´ìš©ì€ ì•„ë‹ˆì§€ë§Œ ì´í•´ë¥¼ ìœ„í•´ì„œ Edge Computingì— ëŒ€í•´ì„œ ì°¾ì•„ë´¤ìŠµë‹ˆë‹¤.

ì„œìš¸ì— ì¡´ì¬í•˜ëŠ” ì»´í“¨í„°ê°€ ë¯¸êµ­ ì›Œì‹±í„´ì— ìˆëŠ” ì„œë²„ì— ìì›ì„ ìš”ì²­í•˜ë©´ ì˜¤ëœ ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì „ ì„¸ê³„ì— CDNì„ êµ¬ì„±í•˜ê³  ê° ì‚¬ìš©ìëŠ” ê°€ê¹Œìš´ ë„¤íŠ¸ì›Œí¬ë¡œë¶€í„° ìì›ì„ ê°€ì ¸ì™€ì„œ ë ˆì´í„´ì‹œë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì´ ë§ì´ ì‚¬ìš©ë˜ëŠ”ë°, ë¬¸ì œëŠ” CDNì—ëŠ” **ì´ë¯¸ì§€, í°íŠ¸, íŒŒì¼, ì›¹ í˜ì´ì§€ ë“±ì˜ ì •ì ì¸ ë°ì´í„°**ë§Œ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë™ì ì¸ ì„œë²„ ì½”ë“œëŠ” CDNì— ì˜¬ë¦´ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ ì‹¤ì œ ë°°í¬ëœ ë¦¬ì „ìœ¼ë¡œ ìš”ì²­í•´ì„œ ì‘ë‹µì„ ë°›ê¸°ê¹Œì§€ ì˜¤ëœ ì‹œê°„ì´ ì†Œìš”ëœë‹¤ëŠ” ë¬¸ì œì ì´ ìˆëŠ”ë°.. **Edge Computing**ì€ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.

Edge í™˜ê²½ì„ ì´ìš©í•˜ë©´ CDN ì„œë²„ì— ë™ì ì¸ ì„œë²„ ì½”ë“œë¥¼ ë™ì‘í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì‹¤í–‰ í™˜ê²½ ì°¨ì´ì 

Node.js, Serverless, Edge ë“± 3ê°€ì§€ì˜ ì‹¤í–‰ í™˜ê²½ì—ëŠ” ì°¨ì´ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/97595cc5-afc2-4c63-923b-e3386b7f9c68)

### Edge í™˜ê²½

Next.js ì—ì„œì˜ Edge Runtime ì€ Node.jsì˜ ì¼ë¶€ APIë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²½ëŸ‰í•œ í•˜ìœ„ ì§‘í•©ì…ë‹ˆë‹¤.

ë§Œì•½ ë™ì ì¸ ìì›ì„ ì œê³µí•˜ë©´ì„œ, ë¹ ë¥¸ ì‘ë‹µ ì†ë„ë¥¼ ê°€ì ¸ì•¼ í•˜ê³ , ê°„ë‹¨í•œ í•¨ìˆ˜ë¼ë©´ Edge Runtimeì„ ì´ìš©í•˜ëŠ”ê²Œ ì´ìƒì ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ Edge Runtime ì—ì„œ ë™ì‘í•˜ê¸° ìœ„í•œ ì œì•½ì‚¬í•­ì´ ë§ì•„ì„œ ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì´ë¥¼ í™œìš©í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ë„ ë§ìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ì„œ ë²ˆë“¤ ì‚¬ì´ì¦ˆê°€ 1MB ~ 4MB ì‚¬ì´ë¥¼ ì´ˆê³¼í•˜ë©´ ì•ˆëœë‹¤ëŠ” ì œì•½ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬, í°íŠ¸, íŒŒì¼ ë“±ë“± ëª¨ë‘ í¬í•¨ë©ë‹ˆë‹¤.

### Node.js í™˜ê²½

ëª¨ë“  Node.js APIì™€ npm íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ Edge í™˜ê²½ì— ë¹„í•´ì„œ ì†ë„ê°€ ëŠë¦½ë‹ˆë‹¤.

Next.jsë¡œ ê°œë°œí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ **ë…¸ë“œ ì„œë²„ì— ë°°í¬**í•˜ê¸° ìœ„í•´ì„œëŠ” ì„œë²„ë¥¼ ê´€ë¦¬í•˜ê³ , ìŠ¤ì¼€ì¼ë§ì„ ê³ ë ¤í•˜ê³ , ì¸í”„ë¼ ì„¤ì •ì„ í•˜ëŠ” ë“±ì˜ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. ì•„ë‹ˆë©´ `Vercel` ì²˜ëŸ¼ **Serverlessë¥¼ ì§€ì›í•˜ëŠ” í”Œë«í¼ì— ë°°í¬**í•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.

### Serverless Node.js í™˜ê²½

Edgeë³´ë‹¤ ë” ë³µì¡í•œ ì»´í“¨íŒ… ë¡œë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í™•ì¥ ê°€ëŠ¥í•œ ì†”ë£¨ì…˜ì´ í•„ìš”í•œ ê²½ìš° ì„œë²„ë¦¬ìŠ¤ê°€ ì´ìƒì ì…ë‹ˆë‹¤. ë²ˆë“¤ ì‚¬ì´ì¦ˆì˜ ì œì•½ì´ 50MBë¡œ Edgeì˜ ë²ˆë“¤ ì‚¬ì´ì¦ˆ ì œì•½(4MB)ì— ë¹„í•´ì„œëŠ” í½ë‹ˆë‹¤.

ë‹¤ë§Œ Edgeì— ë¹„í•´ì„œ ë‹¨ì ë„ ì¡´ì¬í•˜ëŠ”ë°, ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë° ì•ì„œ ì»´í“¨í„°ë¥¼ ê¹¨ìš°ëŠ” ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì´ ë¬¸ì œê°€ ë°”ë¡œ í‰ì†Œì— ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì— ë”°ë¼ì„œ ìì£¼ ê²ªì„ ìˆ˜ ìˆëŠ” Cold Start ë¬¸ì œì…ë‹ˆë‹¤.

## Runtime í™˜ê²½ ì§€ì • ë°©ë²•

íŠ¹ì • route segmentì˜ í•˜ìœ„ì— ëŸ°íƒ€ì„ì„ ì§€ì •í•˜ê¸° ìœ„í•´ì„œëŠ” íŒŒì¼ì— `runtime` ìƒìˆ˜ë¥¼ ì„ ì–¸í•˜ë©´ ë©ë‹ˆë‹¤. ëŒ€ì‹  ê°’ì€ `node.js` í˜¹ì€ `edge` ì—¬ì•¼ë§Œ í•©ë‹ˆë‹¤.

```tsx
export const runtime = 'edge'; // 'nodejs' (default) | 'edge'
```

ì´ëŸ° ë‚´ìš©ì€ `page.js` ì— ì ì–´ë„ ë˜ê³ , `layout.js` ì— ì ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ

[Next.jsì˜ Server actions ê¸°ëŠ¥ (ì½”ë”©ì• í”Œ)](https://codingapple.com/unit/nextjs-server-actions/)
[ì›¹ê°œë°œ, ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ì˜ ë¯¸ë˜? ğŸ˜ (ë“œë¦¼ì½”ë”©)](https://www.youtube.com/watch?v=RLJ6tPzXB5Q)
